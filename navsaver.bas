#RetroDevStudio.MetaData.BASIC:7169,BASIC V7.0,uppercase,10,10
100 FAST
110 DEF FN HB(ZZ)=DEC(LEFT$(HEX$(ZZ),2))
120 DEF FN LB(ZZ)=DEC(RIGHT$(HEX$(ZZ),2))

# 0: CITY HUB EMPORIUM
# 1: CITY HUB GALLERIE
# 2: CITY HUB PLANTATION
# 3: TRAVEL
# 4: HOTEL
# 5: GALLERIE
# 6: BANK
# 7: AUKTIONSHAUS
# 8: PLANTATION
# 9: LAGER MAINMENU (CHOOSE BETWEEN TRANSPORT AND DATES)
#10: MARKTPLATZ
#11: EXPEDITION

#12: BUY PLANTATION
#13: SELL PLANTATION
#14: MANAGE PLANTATION

#16: TRANSPORT PRODUCT

#17: OVERVIEW
#18: SELECT PRODUCE FROM 4 (FOR TRANSPORT OR SALE IN EMPORIUM)
#19: FORWARD CONTRACTS
#20: WORKERS
#21: QUANTITY SELECTION
#22: WORKERS ON PLANTATION
#23: BANK - REEDEREIEN
#24: BANK - DOLLAR
#25: BANK - KREDITE

# ROOM-OPTIONS(ROOM-ID,KEY,VALUE)
#  KEY: 0=ROOM LABEL (SHOWN IN NAVIGATION), 1=OPTION-TARGET
#  VALUE: ACCORDING TO THE KEY
# RC:ROOM COUNT
1200  RC=31:DIM RO%(RC,1,6)
#     NAVIGATION TARGETS
1202  RO%(0,1,0)=3:RO%(0,1,1)=10:RO%(0,1,2)=4:RO%(0,1,3)=6:RO%(0,1,4)=7:RO%(0,1,5)=17
1204  RO%(1,1,0)=3:RO%(1,1,1)=5 :RO%(1,1,2)=4:RO%(1,1,3)=6:RO%(1,1,4)=7:RO%(1,1,5)=17
1206  RO%(2,1,0)=3:RO%(2,1,1)=8 :RO%(2,1,2)=20:RO%(2,1,3)=4:RO%(2,1,4)=6:RO%(2,1,5)=9:RO%(2,1,6)=17
1208  RO%(3,1,0)=-1

1209  RO%(4,1,0)=-1

1210  RO%(5,1,0)=1:RO%(5,1,1)=-1
# BANK:REEDEREIEN/DOLLAR/KREDITE/AUSGANG
1212  RO%(6,1,0)=23:RO%(6,1,1)=24:RO%(6,1,2)=25:RO%(6,1,3)=128
1214  RO%(7,1,0)=128:RO%(7,1,1)=-1

1216  RO%(8,1,0)=12:RO%(8,1,1)=13:RO%(8,1,2)=14:RO%(8,1,3)=22:RO%(8,1,4)=2

1218  RO%(9,1,0)=2:RO%(9,1,1)=-1
#1031  RO%(10,0)=18:RO%(10,1)=19:RO%(10,2)=20:RO%(10,3)=128
1220  RO%(11,1,0)=2:RO%(11,1,1)=-1
1222  RO%(12,1,0)=15:RO%(12,1,1)=15:RO%(12,1,2)=8
1224  RO%(13,1,0)=0:RO%(13,1,1)=-1
1226  RO%(14,1,0)=0:RO%(14,1,1)=-1
#1227  RO%(15,1,0)=0:RO%(15,1,1)=-1
1228  RO%(17,1,0)=128
#1229  RO%(18)
#1230  RO%(19)
#1231  RO%(20)
#1232  RO%(21)

#     WORKERS ENTRY IN PLANTATION
1233  RO%(22,1,0)=128

# BANK - REEDEREIEN:ANKAUF/VERKAUF/AUSGANG - LEAD TO STOCK SELECTOR
1234  RO%(23,1,0)=26:RO%(23,1,1)=27:RO%(23,1,2)=6
# BANK - DOLLAR:ANKAUF/VERKAUF/AUSGANG - LEAD TO QUANTITY SELECTOR
1235  RO%(24,1,0)=28:RO%(24,1,1)=29:RO%(24,1,2)=6
# BANK - KREDITE:TILGEN/AUFNEHMEN/AUSGANG - OPENS QUANTITY SELECTOR
1236  RO%(25,1,0)=30:RO%(25,1,1)=31:RO%(25,1,2)=6

# 26,27 SHOWS STOCK SELECTOR (HANSE, ROYAL, LLOYD, STAR)
1237  RO%(26,1,0)=-1
1238  RO%(27,1,0)=-1

# 28,29 SHOW QUANTITY SELECTOR FOR BUY/SELL DOLLARS
1239  RO%(28,1,0)=-1
1240  RO%(29,1,0)=-1

# 30,31 SHOW QUANTITY SELECTOR FOR PAYBACK/TAKE LOAN
1241  RO%(30,1,0)=-1
1242  RO%(31,1,0)=-1

# WORKERS ON PLANTATION
#1038  RO%(20,1,0)=21:RO%(20,1,1)=22:RO%(20,1,2)=23:RO%(20,1,3)=24:RO%(20,1,4)=128



##############
#     LABELS #
##############
1250  RO%(0,0,0)=1:RO%(0,0,1)=10:RO%(0,0,2)=2:RO%(0,0,3)=4:RO%(0,0,4)=5:RO%(0,0,5)=17
1252  RO%(1,0,0)=1:RO%(1,0,1)=3 :RO%(1,0,2)=2:RO%(1,0,3)=4:RO%(1,0,4)=5:RO%(1,0,5)=17
1254  RO%(2,0,0)=1:RO%(2,0,1)=8 :RO%(2,0,2)=20:RO%(2,0,3)=2:RO%(2,0,4)=4:RO%(2,0,5)=9:RO%(2,0,6)=17

#     TRAVELMENU IS DYNAMICALLY GENERATED (LIST OF LOCATIONS)
1256  RO%(3,0,0)=-1

#     HOTEL MENU IS DYNAMICALLY GENERATED (UNTIL NEXT MONTH, UNTIL NEXT AUCTION DATE)
1257  RO%(4,0,0)=-1


1258  RO%(5,0,0)=0:RO%(5,0,1)=-1
1260  RO%(6,0,0)=27:RO%(6,0,1)=28:RO%(6,0,2)=29:RO%(6,0,3)=0::RO%(6,0,4)=-1
1262  RO%(7,0,0)=0:RO%(7,0,1)=-1

1264  RO%(8,0,0)=12:RO%(8,0,1)=13:RO%(8,0,2)=14:RO%(8,0,3)=20:RO%(8,0,4)=0::RO%(8,0,5)=-1

1266  RO%(9,0,0)=15:RO%(9,0,1)=16:RO%(9,0,2)=0:RO%(9,0,3)=-1
1267  RO%(10,0,0)=13:RO%(10,0,1)=7:RO%(10,0,2)=6:RO%(10,0,3)=0:RO%(10,0,4)=-1

1268  RO%(11,0,0)=0:RO%(11,0,1)=-1
1270  RO%(12,0,0)=15:RO%(12,0,1)=15:RO%(12,0,2)=8:RO%(12,0,3)=-1
1272  RO%(13,0,0)=25:RO%(13,0,1)=26:RO%(13,0,2)=-1
1274  RO%(14,0,0)=0:RO%(14,0,1)=-1
1275  RO%(15,0,0)=25:RO%(15,0,1)=26:RO%(15,0,2)=-1
#     OTRAPRO. LIST OF PRODUCTS IS DYNAMICALLY GENERATED
1276  RO%(16,0,0)=-1

#     OVERVIEW
1277  RO%(17,0,0)=0:RO%(17,0,1)=-1

#     OSEL4PRO. LIST OF PRODUCTS IS DYNAMICALLY GENERATED
1278  RO%(18,0,0)=-1

#     FORWARD CONTRACTS
1279  RO%(19,0,0)=0:RO%(19,0,1)=-1

# WORKERS TOP LEVEL MENU
1280  RO%(20,0,0)=21:RO%(20,0,1)=22:RO%(20,0,2)=23:RO%(20,0,3)=24:RO%(20,0,4)=0::RO%(20,0,5)=-1

# QUANTITY SELECTOR
1281  RO%(21,0,0)=-1

# WORKERS ENTRY ON PLANTATION
1282  RO%(22,0,0)=0:RO%(22,0,1)=-1

# BANK - REEDEREIEN:ANKAUF/VERKAUF/AUSGANG
1283  RO%(23,0,0)=12:RO%(23,0,1)=13:RO%(23,0,2)=0:RO%(23,0,3)=-1
# BANK - DOLLAR:ANKAUF/VERKAUF/AUSGANG
1284  RO%(24,0,0)=12:RO%(24,0,1)=13:RO%(24,0,2)=0:RO%(24,0,3)=-1
# BANK - KREDITE:TILGEN/AUFNEHMEN/AUSGANG
1285  RO%(25,0,0)=30:RO%(25,0,1)=31:RO%(25,0,2)=0:RO%(25,0,3)=-1

# LIST REEDEREIEN
1286  RO%(26,0,0)=32:RO%(26,0,1)=33:RO%(26,0,2)=34:RO%(26,0,3)=35:RO%(26,0,4)=0:RO%(26,0,5)=-1
1287  RO%(27,0,0)=32:RO%(27,0,1)=33:RO%(27,0,2)=34:RO%(27,0,3)=35:RO%(27,0,4)=0:RO%(27,0,5)=-1

1288  RO%(28,0,0)=-1
1289  RO%(29,0,0)=-1

1290  RO%(30,0,0)=-1
1291  RO%(31,0,0)=-1


# CM%(ROOM-ID,#): CHOICEMENU
# 0: INPUT-LENGTH (PREVIOUSLY VARIABLE IL)
# 1: OPTION COUNT (PREVIOUSLY VARIABLE OC)
1450  DIM CM%(RC,1)
1451  CM%(0,0)=10:CM%(0,1)=5
1452  CM%(1,0)=10:CM%(1,1)=5
1453  CM%(2,0)=10:CM%(2,1)=6
1454  CM%(3,0)=11:CM%(3,1)=15
1455  CM%(4,0)=10:CM%(4,1)=2
1456  CM%(5,0)=10:CM%(5,1)=0
1457  CM%(6,0)=10:CM%(6,1)=3
1458  CM%(7,0)=10:CM%(7,1)=0
1459  CM%(8,0)=10:CM%(8,1)=4
1460  CM%(9,0)=18:CM%(9,1)=2
1461  CM%(10,0)=9:CM%(10,1)=3
1462  CM%(11,0)=10:CM%(11,1)=0
1463  CM%(12,0)=10:CM%(12,1)=2
1464  CM%(13,0)=10:CM%(13,1)=1
1465  CM%(14,0)=10:CM%(14,1)=0
1466  CM%(15,0)=10:CM%(15,1)=1
1467  CM%(16,0)=10:CM%(16,1)=2
1468  CM%(17,0)=10:CM%(17,1)=0
1469  CM%(18,0)=7:CM%(18,1)=4
1470  CM%(19,0)=10:CM%(19,1)=0
1472  CM%(20,0)=10:CM%(20,1)=4
1473  CM%(21,0)=10:CM%(21,1)=0
1474  CM%(22,0)=10:CM%(22,1)=0
1475  CM%(23,0)=10:CM%(23,1)=2
1476  CM%(24,0)=10:CM%(24,1)=2
1477  CM%(25,0)=10:CM%(25,1)=2
1478  CM%(26,0)=7:CM%(26,1)=4
1479  CM%(27,0)=7:CM%(27,1)=4
1480  CM%(28,0)=7:CM%(28,1)=0
1481  CM%(29,0)=7:CM%(29,1)=0
1482  CM%(30,0)=7:CM%(30,1)=0
1483  CM%(31,0)=7:CM%(31,1)=0


####
# FILE STRUCTURE
# 0: OFFSET ROOM-1
# 1: ENTRIES ROOM-1
# 2: OFFSET ROOM-2
# 3: ENTRIES ROOM-2

# AT OFFSET: 1 BYTE PER ENTRY
# INDEX OF ROOM-ENTRIES IS ROOM-ID X 2

# WRITE LABELS
# OS:OFFSET
2000 PA=DEC("1300")
2001 O1=0:O2=(RC+1)*4
2002 BANK 0

2010 FOR R=0 TO RC

2011  PRINT "R="R",IDX="O1",OFF="O2",WDT="CM%(R,0)",CNT="CM%(R,1)
2012  POKE PA+O1,FNLB(O2):O1=O1+1
2013  POKE PA+O1,FNHB(O2):O1=O1+1

2015  POKE PA+O1,CM%(R,0)
2016  O1=O1+1

2017  POKE PA+O1,CM%(R,1)
2018  O1=O1+1

2020  FOR E=0 TO CM%(R,1)
#      LABEL IS SET TO -1? SKIP ALL CONTENT OF THIS ROOM
2021   IF RO%(R,0,E)<0 THEN E=CM%(R,1):GOTO 2035
#      TARGET IS SET TO -1? SET VALUE TO 255
2022   IF RO%(R,1,E)<0 THEN V=255:ELSE V=RO%(R,1,E)

2023   PRINT " 0:"E"="RO%(R,0,E)" AT "O2
2025   POKE PA+O2,RO%(R,0,E)
2030   O2=O2+1
2031   PRINT " 1:"E"="RO%(R,1,E)" AT "O2
2032   POKE PA+O2,V
2033   O2=O2+1
2035  NEXT

2040 NEXT


2100 PRINT "DONE. INSERT DISK"
2110 GETKEY I$

2120 BSAVE "@NAVLABELS",U8,P(PA)TOP(PA+O2),B0

