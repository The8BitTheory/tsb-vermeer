#RetroDevStudio.MetaData.BASIC:2049,Tuned Simons' BASIC,lowercase,10,10
# ALLO OODWELL! :-)

# CH HAB EIGENTLICH NUR ZWEI NMERKUNGEN ZU DEINEM IDEO. AS EINE IST, DASS
# DU DEN EFEHL  NICHT ZU KENNEN SCHEINST, ER DIENT DAZU, TELLEN AUF DEM
# ILDSCHIRM ZU INVERTIEREN. A ERUEBRIGT SICH EINE ZWEIFACHE EXTAUSGABE (EIN-
# MAL REVERS).

# AS ANDERE IST DIE GROSSE NTERSTUETZUNG, DIE  EINEM GEBEN KANN, WENN MAN
# STRUKTURIERTE ROGRAMME ENTWICKELN MOECHTE.

# EIN ROGRAMM WAR NATUERLICH TOTALER PAGHETTI-ODE, SOLLTE ES JA AUCH SEIN
# ("MAN KANN MIT  MAL EBEN WAS ZAUBERN"). BER  ERLEICHTERT *UNGEMEIN* DAS
# STRUKTURIERTE ODEN UND LANEN! ELCHE EATURES SOLL MEIN ROGRAMM HABEN?
# ANN ICH DIE AUF EINE UNKTION HERUNTERBRECHEN, DIE IN EINE ROZEDUR PASST?

# N DEN ALLERMEISTEN AELLEN FINDEST DU MIT  DAZU GUTE NTWORTEN, LEICHT
# NACHVOLLZIEHBAR, KURZ UND SCHNELL IM BLAUF.

# N MEINER ERSION VON DEINEM ROGRAMM HIER HABE ICH DAS ALLES ZU VERDEUTLICHEN
# VERSUCHT. ENN ICH DABEI ETWAS UEBER DAS IEL HINAUSGESCHOSSEN BIN, BITTE
# NICHT BOESE SEIN. AS PASSIERT HALT SO IM LOW! ;-)

# -----------------------------------------------------------------------------

# S GEHT LOS:  *OHNE* ARAMETER MACHT SOWOHL ILDSCHIRM ALS AUCH AHMEN
# SCHWARZ, DER URSOR BLEIBT WIE ER WAR. IER MACHT DAS INN, DENN DIE URSOR-
# FARBE KOMMT ERST SPAETER INS PIEL (IN  SCREEN).

# TRUKTURIERUNG: IES HIER IST DAS AUPTPROGRAMM: > INIT:SCREEN:MENUE <.
# N SO EINE UFTEILUNG HAB ICH MICH SCHNELL GEWOEHNT. IE IST IMMER DER ERSTE
# CHRITT ZU (WEITERER) TRUKTUR. AST ALLE MEINE -ROGRAMME FANGEN SO AN.

100 COLOUR0,0,1:CA=$E800
105 IFA=0THENA=1:MEM:PRINT"ADE EICHENSATZ":LOAD"TSB2.SET",0,0,CA
110 INIT:SCREEN:MENUE
120 NRM:CLS:COLOUR11,12,0
130 END

# INIT: RRAYS, IHRE EFUELLUNG, WICHTIGE ARIABLEN, DIE ZUERST IM UCHPROZESS
# DES NTERPRETERS STEHEN MUESSEN. EICHENSATZ. : AMIT HAST DU GROSSE
# LEXIBILITAET BEIM EFUELLEN VON RRAYS GEWONNEN! IN WAHRER EGEN! CH HABE
# DESHALB ABSICHTLICH DIE -EILEN ETWAS VERTEILT. EI  WIRD 
# BERUECKSICHTIGT (AUCH WICHTIG!) -  BESCHLEUNIGT ALLE S. AS
# CHLUESSELWORT  HABE ICH GRUNDSAETZLICH WEGGELASSEN, DAS ABEL ALLEIN
# REICHT JA ALS ROZEDURAUFRUF. EBRIGENS IST  *MIT* CHLUESSELWORT GERING-
# FUEGIG SCHNELLER ALS OHNE (DIE RKENNUNG ALS -UFRUF FAELLT BEI VORHAN-
# DENEM  WEG).

1000 PROC INIT

1002  CHECK
1010  INITMOUSE

1015  DIM M$(11),F%(1,6),BD$,I,I1:F=11:FS=12:FB=6:IL=10:ID=0:MI=0


#PD(PLAYER-ID,#): LAYER ATA
#              0: CURRENT CITY
#              1: CASH
1016  DIM PD(1,1)
1017  PD(0,0)=5:PD(0,1)=50000

#GS(#): GAME STATE
#   0: CURRENT PLAYER
#   1: CURRENT ROOM
1018  DIM GS(1)
#     PLAYER STARTS IN BERLIN
1019  GS(0)=0:GS(1)=1

# ROOMS:
# 0: CITY HUB EMPORIUM
# 1: CITY HUB GALLERIE
# 2: CITY HUB PLANTAGE
# 3: TRAVEL
# 4: HOTEL
# 5: GALLERIE
# 6: BANK
# 7: AUKTIONSHAUS
# 8: PLANTAGE
# 9: LAGER
#10: MARKTPLATZ
#11: EXPEDITION

# ROOM-OPTIONS(ROOM-ID,OPTION-TARGET)
1020  DIM RO(11,5)
1021  RO(0,0)=3:RO(0,1)=10:RO(0,2)=4:RO(0,3)=6:RO(0,4)=7:RO(0,5)=-1
1022  RO(1,0)=3:RO(1,1)=5 :RO(1,2)=4:RO(1,3)=6:RO(1,4)=7:RO(1,5)=-1
1023  RO(2,0)=3:RO(2,1)=8 :RO(2,2)=4:RO(2,3)=6:RO(2,4)=11:RO(2,5)=9
1024  RO(3,0)=128:RO(3,1)=-1
1025  RO(4,0)=128:RO(4,1)=-1
1026  RO(5,0)=1:RO(5,1)=-1
1027  RO(6,0)=128:RO(6,1)=-1
1028  RO(7,0)=128:RO(7,1)=-1
1029  RO(8,0)=2:RO(8,1)=-1
1030  RO(9,0)=2:RO(9,1)=-1
1031  RO(10,0)=0:RO(10,1)=-1
1032  RO(11,0)=2:RO(11,1)=-1


1035  M$(0)="USGANG   ":M$(1)="USGANG   ":M$(2)="USGANG   ":M$(3)="EISEN    "
1036  M$(4)="OTEL     ":M$(5)="ALERIE   ":M$(6)="ANK      ":M$(7)="UKTION   "
1037  M$(8)="LANTAGE  ":M$(9)="AGERHAUS ":M$(10)="ARKT     ":M$(11)="XPEDITION"

1040  RESET 58250

1045  FOR I=1 TO 9
1046   READ A:BD$=BD$+CHR$(A)
1047  NEXT

1050  RESET 1180

1055  FOR I=1 TO 6
1056   READ F%(0,I)
1057  NEXT
1058  FOR I=1 TO 6
1059   READ F%(1,I)
1060  NEXT

1065  ZEICHEN
1066  INITCITIES

1070 END PROC


# ARBEN
1180 DATA 15, 9,11, 2, 5, 6
1181 DATA  1, 2,15,10,13,14


# TRUKTUR: ILDSCHIRMAUFBAU MIT BLEIBENDEN NHALTEN IN EINEM EIGENEN . IER
# HAST DU IN DEINEM IDEO JA AUCH VARIABLE ERTE EINGEBAUT (DIE ARBEN), GERE-
# GELT DURCH DIE ARIABLE . EI UFRUFEN VON NTERPROGRAMMEN (FRAME) SETZE ICH
# ALLE NOETIGEN ARAMETER MOEGLICHST DAVOR IN DIE GLEICHE EILE, DAS SCHAFFT
# LARHEIT. - EINE RLAEUTERUNG ZU  IM IDEO FAND ICH SEHR ANSCHAULICH!

# UNKTIONEN: AS BRAUCHT MAN ZUR ARSTELLUNG AUF DEM ILDSCHIRM: AESTEN,
# CHATTEN, NHALTE, REALISIERT MIT FRAME, DANACH  (ODER  (..) ).
# ENN EIN ENUE DABEI IST WIE HIER: MENUE, ITEM UND TAG (ENUEPUNKT UND AR-
# KIERUNG DESSELBEN). N MENUE FINDET DIE ROGRAMMSTEUERUNG STATT (CHLEIFE MIT
# ). CH LESE ZUR ERMEIDUNG VON TRINGMUELL UND ZUR BLAUFBESCHLEUNIGUNG
# DEN ASTENDRUCK BEI  DIREKT AUS DEM INGABEPUFFER AUS (512). UR E-
# FUELLUNG DES ENUES DIENT ' ITEMS'.


# ILDSCHIRMMASKE
6800 PROC SCREEN
6810  FILL 0,0,40,25,0,15
6811  COLOUR,1

6815  PRINT AT(0,0) GS(1)

6820  IF GS(1)<2 THEN IL=10:OC=4:ROOMCITYHUB
6821  IF GS(1)=2 THEN IL=10:OC=5:ROOMCITYHUB
6823  IF GS(1)=3 THEN IL=11:OC=21:ROOMTRAVEL
6825  IF GS(1)=4 THEN IL=10:OC=0:ROOMHOTEL
6827  IF GS(1)=5 THEN IL=10:OC=0:ROOMGALLERY
6828  IF GS(1)=6 THEN IL=10:OC=0:ROOMBANK
6829  IF GS(1)=7 THEN IL=10:OC=0:ROOMAUCTION
6830  IF GS(1)=8 THEN IL=10:OC=0:ROOMPLANTAGE
6831  IF GS(1)=9 THEN IL=10:OC=0:ROOMWAREHOUSE
6832  IF GS(1)=10 THEN IL=10:OC=0:ROOMMARKETPLACE
6833  IF GS(1)=11 THEN IL=10:OC=0:ROOMEXPEDITION

6860  TAG

6870 END PROC


########################
# KTUELLER RT UND ATUM
# ANK, LANTAGE, ITYHUB, ALLERIE
6900 PROC LOCDATECASHHEADER

6901  BX=1:BY=1:BW=26:BH=3:FRAME
6902  PRINT AT(BY+1,BX+1) TX$(PD(0,0),0)

# NZEIGE ARVERMOEGEN
6903  BX=27:BY=1:BW=12:BH=3:FRAME
6904  PRINT AT(BY+1,BX+1) PD(0,1)" "

6905 END PROC





################
# USWAHLMENUE
# UEBERALL AUSSER EISEN
6910 PROC CHOICEMENU

#6915  BX=26:BY=15:BW=12:BH=8:FRAME
6912  BX=27:BY=20-OC:BW=12:BH=3+OC:FRAME

#     IN ENUE BEFUELLEN
6914  FOR I1=0 TO OC

#      INEN EINZELNEN ENUEPUNKT AUSGEBEN
6916   TV=RO(GS(1),I1)
6918   IF TV=128 THEN TV=0
6920   IF TV>=0 THEN PRINT AT(BY+I1+1,BX+1) M$(TV);

6922  NEXT

6924 END PROC


######
# GENERIC BOX WITH TEXT
#######
6930 PROC BOXWITHTEXT

6932  BX=1:BY=6:BW=20:BH=5:FRAME
6934  CENTER AT(BY+2,BX)TX$,BW

6939 END PROC



###################
# TADTBILDSCHIRM #
###################
7000 PROC ROOMCITYHUB

7001  LOCDATECASHHEADER
7002  CHOICEMENU

7199 END PROC



###################
# EISEBILDSCHIRM #
###################
7200 PROC ROOMTRAVEL

#     RAHMEN FUER WELTKARTE
7202  BX=1:BY=1:BW=24:BH=17:FRAME

#     ANZEIGE SPIELERNAME UND AKTUELLE STADT
7210  BX=1:BY=20:BW=24:BH=3:FRAME

#     AUSWAHL DER STADT
7220  TRAVELCHOICE
7249 END PROC


# ISTE DER TAEDTE
7250 PROC TRAVELCHOICE

7255  BX=26:BY=0:BW=13:BH=24:FRAME

7265  FOR I1=0 TO 20
7270   PRINT AT(BY+I1+1,BX+1) TX$(I1,0);
7275  NEXT

7278  PRINT AT(BY+21+1,BX+1) M$(0)+" ";

7290 END PROC



#########
# OTEL #
#########
7400 PROC ROOMHOTEL
7402  LOCDATECASHHEADER

7410  TX$="OTEL":EXEC BOXWITHTEXT

7420  CHOICEMENU

7599 END PROC


########
# ANK #
########
7600 PROC ROOMBANK

7602  LOCDATECASHHEADER

#     TRESORE
7604  BX=1:BY=3:BW=38:BH=10:FRAME

#     LISTE DER AKTIENKURSE
7606  BX=1:BY=15:BW=22:BH=6:FRAME

7608  CHOICEMENU

7799 END PROC


###########
# ALERIE #
###########
7800 PROC ROOMGALLERY

7810  LOCDATECASHHEADER
7820  TX$="ALERIE":EXEC BOXWITHTEXT
7830  CHOICEMENU

7999 END PROC


###########
# UKTION #
###########
8000 PROC ROOMAUCTION

8010  LOCDATECASHHEADER
8020  TX$="UKTION":EXEC BOXWITHTEXT
8030  CHOICEMENU

8199 END PROC


############
# LANTAGE #
############
8200 PROC ROOMPLANTAGE

8210  LOCDATECASHHEADER
8220  TX$="LANTAGE":EXEC BOXWITHTEXT
8230  CHOICEMENU

8399 END PROC

#############
# AREHOUSE #
#############
8400 PROC ROOMWAREHOUSE

8410  LOCDATECASHHEADER
8420  TX$="AGERHAUS":EXEC BOXWITHTEXT
8430  CHOICEMENU

8599 END PROC

###############
# ARKETPLACE #
###############
8600 PROC ROOMMARKETPLACE

8610  LOCDATECASHHEADER
8620  TX$="ARKTPLATZ":EXEC BOXWITHTEXT
8630  CHOICEMENU

8799 END PROC

##############
# XPEDITION #
##############
8800 PROC ROOMEXPEDITION

8810  LOCDATECASHHEADER
8820  TX$="XPEDITION":EXEC BOXWITHTEXT
8830  CHOICEMENU

8999 END PROC



# INEN ASTEN MIT CHATTEN MALEN, DIE ARBEN SIND IN EINEM RRAY, DAMIT MAN
# DIE ARBKOMBINATIONEN UNTER ONTROLLE HAT.

58200 PROC FRAME
58210  INSERT BD$,BY,BX,BW,BH,FB
58220  FCOL BY+BH,BX+1,BW,1,11:REM F%(0,ID)
58225  FCOL BY+1,BX+BW,1,BH,11:REM F%(0,ID)
58230 END PROC

# AHMENZEICHEN
58250 DATA 111,183,112,180,32,170,108,187,188



# TATT OPPELAUSGABE (EINMAL DAVON REVERS) EINFACH  VERWENDEN!

# INEN ENUEPUNKT MARKIEREN
58400 PROC TAG
58410  INV BY+ID+1,BX+1,IL,1
58420 END PROC

# AS ENUE, IN EINER CHLEIFE. CH VERSUCHE IMMER JEGLICHE ORM VON  ZU
# VERMEIDEN, DAMIT EIN ROGRAMM JEDERZEIT MOEGLICHST EINFACH ZU VERAENDERN IST.

58440 PROC MENUE
#8442  TAG

58443  LOOP
58444   IF MI THEN QRYMOUSE
58446   IF NOT MI THEN QRYKBD
58448  END LOOP

58450 END PROC


#OC:OPTION COUNT (MAX CHOICE INDEX)
58455 PROC QRYKBD
58458  Q=0
58460  OC=4

58462  REPEAT

58464   R=0:KEYGET I$:I=PEEK(512)

58466   IF I=145 THEN TAG:ID=ID-1:R=-1:IF ID<0 THEN ID=OC
58468   IF I=17 THEN TAG:ID=ID+1:R=-1:IF ID>OC THEN ID=0

58470   IF I=13 THEN HANDLEENTER

58476   IF I=ASC("I") THEN MI=-1:Q=-1
58478   IF R THEN TAG

58480  UNTIL Q=-1
58482 END PROC



58485 PROC HANDLEENTER
58486  IF GS(1)=3 THEN EXEC HANDLETRAVELCHOICE: ELSE EXEC HANDLECHOICE

58489 END PROC



58490 PROC HANDLECHOICE

58492  TV=RO(GS(1),ID)
58493  IF TV<128 THEN GS(1)=TV: ELSE EXEC FILLCURCITY
58495  ID=0
58496  SCREEN

58499 END PROC




58500 PROC HANDLETRAVELCHOICE

58505  IF ID<21 THEN PD(0,0)=ID

58515  EXEC FILLCURCITY

58535  ID=0:SCREEN

58549 END PROC



58550 PROC FILLCURCITY
58560   GS(1)=2
58570   IF TX$(PD(0,0),1)="" THEN GS(1)=0
58580   IF TX$(PD(0,0),1)="" THEN GS(1)=1
58599 END PROC




# AUSABFRAGE
58600 PROC QRYMOUSE

58602  Q=0:MOB ON 0
58605  REPEAT

58610   GET X$

58615   IF X$=CHR$(160) THEN CLICKP
#1517   IF JOY(1)=1 THEN CLICKS

58620   X0=INT(PEEK($D000)):X1=PEEK($D010 )AND 1:Y0=PEEK($D001):X=X0+256*X1
58630   X=INT(X0+X1*256):Y=INT(Y0)

58640   USE AT(17,18)"X =-###",X:USE AT(18,18)"Y =-###",Y:X$=""

58645   GET I$:IF LEN(I$)>0 THEN IF I$="I" THEN MI=0:Q=-1

58650  UNTIL Q=-1
58658  MOB OFF 0

58660 END PROC



# CLICK PRIMAERE MAUSTASTE (LINKS)
58700 PROC CLICKP
58710  PRINT AT(19,18)"LINKS "
58799 END PROC

# CLICK SEKUNDAERE MAUSTASTE (RECHTS)
58800 PROC CLICKS
58810  PRINT AT(19,18)"RECHTS"
58899 END PROC


58900 PROC INITMOUSE
58901  IF PEEK(828)<>$AD THEN PRINT"ADE AUSTREIBER":LOAD"MAUS.DRV",0,0,$0334
58910  DESIGN 0,$C000
58912  @BBB.....................
58914  @BBBBB...................
58916  @BBBBBBB.................
58918  @BBBBBBBBB...............
58920  @BBBBB...................
58922  @BB..BBB.................
58924  @B....BBB................
58926  @......BBB...............
58928  @.......BB...............
58930  @........................
58932  @........................
58934  @........................
58936  @........................
58938  @........................
58940  @........................
58942  @........................
58944  @........................
58946  @........................
58948  @........................
58950  @........................
58952  @........................
58954  MOB SET 0,0,15,128,0
58956  SYS$033C:RLOCMOB0,160,100,0,1
58958  MOB OFF 0
58959 END PROC


# REI RTEN VON TAEDTEN:
# * ONDON UND EW ORK:
#   - EISEN
#   - ARKTPLATZ
#   - OTEL
#   - ANK
#   - UKTIONSHAUS

# * MSTERDAM, OM, ISSABON, ARIS, ERLIN UND AN RANCISCO
#   - EISEN
#   - ALLERIE
#   - OTEL
#   - ANK
#   - UKTIONSHAUS

# * LLE ANDEREN 15 TADTE: LANTAGEN
#   - EISEN
#   - LANTAGE
#   - RBEITER
#   - OTEL
#   - AGER
# NKARA,OMBAY,OLOMBO,OMBASA,UALA,BIDJAN,IO,OGOTA
# UATEMALA,EXICO ITY,AVANA,T.OUIS,ATAVIA,ONGKONG,OKYO

59000 PROC INITCITIES
59005  PRINT "EREISE DIE ELT..."
# 0:AME DER TADT
# 1: ODER  (MPORIUM, ALLERY) ODER IFFER FUER ERSTES RODUKT
# 2:IFFER FUER ZWEITES RODUKT
# 3:IFFER FUER HIPPING OMPANY
59010  DIM TX$(22,3)
59011  OPEN 1,8,3,"CITIES,S,R"
59020  FOR L=0 TO 22

59030   INPUT#1,TX$(L,0),TX$(L,1),TX$(L,2),TX$(L,3)

59070  NEXT
59080  CLOSE 1
59099 END PROC



# EICHENDEFINITIONEN SETZE ICH ANS ROGRAMMENDE (ODER LADE SIE EINFACH AUS
# EINER ATEI, UND ZWAR VIA , DA MUSS ICH KEINE UECKSICHT AUF DEN RT DES
# ODES IM ROGRAMM NEHMEN). ENN ICH EICHEN LADE, HABE ICH SIE ENTWEDER MIT
# EINEM EIGENS DAFUER GEMACHTEN -ROGRAMM ERZEUGT ODER MIT EINEM HAR-DITOR,
# Z.. DEM VON OLOAK ODER MEGA.

60000 PROC ZEICHEN
60001  DESIGN2,CA+8*0
60002  @.B.BBBB.
60003  @B.BBBB.B
60004  @.B.BB.BB
60005  @BBB..BBB
60006  @BBB..BBB
60007  @BB.BB.B.
60008  @B.BBBB.B
60009  @.BBBB.B.
60010  DESIGN2,CA+8*111
60011  @........
60012  @.BBBBBBB
60013  @.B......
60014  @.B.BBBBB
60015  @.B.B....
60016  @.B.B....
60017  @.B.B....
60018  @.B.B....
60019  DESIGN2,CA+8*119
60020  @........
60021  @BBBBBBBB
60022  @........
60023  @BBBBBBBB
60024  @........
60025  @........
60026  @........
60027  @........
60028  DESIGN2,CA+8*112
60029  @........
60030  @BBBBBBB.
60031  @......B.
60032  @BBBBB.B.
60033  @....B.B.
60034  @....B.B.
60035  @....B.B.
60036  @....B.B.
60037  DESIGN2,CA+8*123
60038  @........
60039  @........
60040  @........
60041  @........
60042  @BBBBBBBB
60043  @........
60044  @BBBBBBBB
60045  @........
60046  DESIGN2,CA+8*116
60047  @.B.B....
60048  @.B.B....
60049  @.B.B....
60050  @.B.B....
60051  @.B.B....
60052  @.B.B....
60053  @.B.B....
60054  @.B.B....
60055  DESIGN2,CA+8*106
60056  @....B.B.
60057  @....B.B.
60058  @....B.B.
60059  @....B.B.
60060  @....B.B.
60061  @....B.B.
60062  @....B.B.
60063  @....B.B.
60064  DESIGN2,CA+8*108
60065  @.B.B....
60066  @.B.B....
60067  @.B.B....
60068  @.B.B....
60069  @.B.BBBBB
60070  @.B......
60071  @.BBBBBBB
60072  @........
60073  DESIGN2,CA+8*124
60074  @....B.B.
60075  @....B.B.
60076  @....B.B.
60077  @....B.B.
60078  @BBBBB.B.
60079  @......B.
60080  @BBBBBBB.
60081  @........
60082 END PROC